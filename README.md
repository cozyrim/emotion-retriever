# Facial Expression Text-Image Zero-Shot Retrieval 

![Demo](https://github.com/cozyrim/emotion-retriever/blob/main/assets/demogui.gif)

 **ì œë¡œìƒ· í•™ìŠµ(Zero-Shot Learning)** ê¸°ë°˜ì˜ **CLIP(Contrastive Language-Image Pre-training)** ëª¨ë¸ì„ í™œìš©í•˜ì—¬ <br/>
í…ìŠ¤íŠ¸ë¡œ ë¬˜ì‚¬í•œ ì–¼êµ´ í‘œì •ê³¼ ì´ë¯¸ì§€ ê°„ì˜ ê´€ê³„ë¥¼ ë¶„ì„í•˜ê³  ì‹¤ì‹œê°„ìœ¼ë¡œ ê´€ë ¨ ì´ë¯¸ì§€ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” GUIë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“„ ë…¼ë¬¸ ê°œìš”

**ì œëª©**: ì œë¡œìƒ· í•™ìŠµì„ í†µí•œ ì–¼êµ´ í‘œì • ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ì˜ ê´€ê³„ ì¶”ë¡    
**ì €ì**: Chaerim Han, Deokwoo Lee  
**ì†Œì†**: ê³„ëª…ëŒ€í•™êµ ì»´í“¨í„°ê³µí•™ê³¼  

ë³¸ ì—°êµ¬ëŠ” CLIP ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ì˜ ë‹¨ìˆœí•œ 7ê°€ì§€ í‘œì •(ì¤‘ë¦½, í–‰ë³µ, ìŠ¬í””, ë†€ëŒ, ë‘ë ¤ì›€, í˜ì˜¤, ë¶„ë…¸, ê²½ë©¸)ì„ ë„˜ì–´, ë¬¸ì¥ í˜•íƒœì˜ ë¬˜ì‚¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë”ìš± ë‹¤ì–‘í•˜ê³  ë³µì¡í•œ í‘œì •ì„ ì¸ì‹í•˜ê³  ë¶„ë¥˜í•˜ëŠ” ì œë¡œìƒ· í•™ìŠµ ë°©ë²•ì„ ì œì•ˆí•©ë‹ˆë‹¤. ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ê°„ì˜ ë³µì¡í•œ ê´€ê³„ë¥¼ í•™ìŠµí•˜ì—¬ ê¸°ì¡´ ë°©ë²• ëŒ€ë¹„ í­ë„“ê³  ì„¸ë°€í•œ ë¶„ì„ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

---

## ğŸ“š ì£¼ìš” ì—°êµ¬ ë‚´ìš©

- ê¸°ì¡´ 7ê°€ì§€ ê¸°ë³¸ í‘œì • ë¶„ë¥˜ë¥¼ ë„˜ì–´ í…ìŠ¤íŠ¸ ë¬¸ì¥ìœ¼ë¡œ ì–¼êµ´ í‘œì •ì˜ ì˜ë¯¸ì  íŠ¹ì„±ì„ í•™ìŠµ  
- CLIP ëª¨ë¸ì„ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ì™€ ë¬¸ì¥ ê°„ì˜ ê´€ê³„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì¶”ë¡   
- ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ê°ê° ì„ë² ë”©í•˜ì—¬ ìœ ì‚¬ë„ë¥¼ cosine similarityë¥¼ í†µí•´ ì¸¡ì •  
- ì œë¡œìƒ· í•™ìŠµ ê¸°ë²•ìœ¼ë¡œ í•™ìŠµ ë°ì´í„°ì— ì—†ëŠ” ìƒˆë¡œìš´ í‘œì • í‘œí˜„ë„ ì¸ì‹ ê°€ëŠ¥

ìì„¸í•œ ë‚´ìš©ê³¼ ì‹¤í—˜ ê²°ê³¼ëŠ” ì²¨ë¶€ëœ ë…¼ë¬¸ PDFë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

ğŸ“• [ë…¼ë¬¸ PDF ë‹¤ìš´ë¡œë“œ](./paper.pdf)

---


## ğŸš€ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
.
â”œâ”€â”€ demo.py             # GUI ì•± (Gradio ê¸°ë°˜, ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ê²€ìƒ‰ ê¸°ëŠ¥)
â”œâ”€â”€ train.py            # CLIP ëª¨ë¸ í•™ìŠµ ë° ê²€ì¦
â”œâ”€â”€ dataset.py          # ë°ì´í„°ì…‹ ì²˜ë¦¬ ë° ì „ì²˜ë¦¬ ê³¼ì • ì •ì˜
â”œâ”€â”€ model.py            # ëª¨ë¸ ì •ì˜ (CLIP ëª¨ë¸: ResNet50 + DistilBERT)
â”œâ”€â”€ config.py           # ì„¤ì • (ê²½ë¡œ, í•˜ì´í¼íŒŒë¼ë¯¸í„°, GPU ì„¤ì • ë“±)
â”œâ”€â”€ utils.py            # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (ëª¨ë¸ ì €ì¥ ë° ë¡œë“œ ë“±)
â”œâ”€â”€ images/             # ì–¼êµ´ í‘œì • ì´ë¯¸ì§€ ë°ì´í„°ì…‹
â”œâ”€â”€ captions.csv        # ì´ë¯¸ì§€ íŒŒì¼ê³¼ í…ìŠ¤íŠ¸(ìº¡ì…˜) ë§¤í•‘ ë°ì´í„°
â””â”€â”€ requirements.txt    # Python ì˜ì¡´ì„± íŒ¨í‚¤ì§€
```

---

## ğŸ›  ì„¤ì¹˜ ë° ì‚¬ìš©ë²•

### í™˜ê²½ ì„¤ì •

```bash
git clone https://github.com/your-username/facial-expression-retrieval.git
cd facial-expression-retrieval

python -m venv venv
# macOS/Linux
source venv/bin/activate
# Windows
venv\Scripts\activate

pip install --upgrade pip
pip install -r requirements.txt
```

### ë°ì´í„° ì¤€ë¹„

- ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ `images/` í´ë”ì— ë°°ì¹˜í•©ë‹ˆë‹¤.
- `captions.csv` íŒŒì¼ì„ ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ë¬˜ì‚¬ í˜•ì‹ìœ¼ë¡œ êµ¬ì„±í•©ë‹ˆë‹¤.
- ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ `model_final.pth`ë¥¼ í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤.

### GUI ì‹¤í–‰

```bash
python demo.py
```

ë¸Œë¼ìš°ì €ì—ì„œ `http://127.0.0.1:7860` ì ‘ì† í›„,  
í…ìŠ¤íŠ¸ë¡œ ì–¼êµ´ í‘œì •ì„ ë¬˜ì‚¬í•˜ì—¬ ì´ë¯¸ì§€ ê²€ìƒ‰ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

ì˜ˆì‹œ:
> An expression of shock and astonishment.

---

## ğŸ“¬ ì—°ë½ì²˜

cozyriming@gmail.com   

